(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8478:function(e,t,a){Promise.resolve().then(a.bind(a,9729))},9729:function(e,t,a){"use strict";a.d(t,{Chat:function(){return B}});var s=a(7437),n=a(2265),r=a(1817),i=a(5805),l=a(221),c=a(9985),o=a(2660),d=a(2529),u=a(8098),m=a(8997),p=a(2489),h=a(4743),f=a(7053),x=a(535),b=a(1994),g=a(3335);function v(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,g.m6)((0,b.W)(t))}let y=(0,x.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),j=n.forwardRef((e,t)=>{let{className:a,variant:n,size:r,asChild:i=!1,...l}=e,c=i?f.g7:"button";return(0,s.jsx)(c,{className:v(y({variant:n,size:r,className:a})),ref:t,...l})});j.displayName="Button";let N=n.forwardRef((e,t)=>{let{className:a,type:n,...r}=e;return(0,s.jsx)("input",{type:n,className:v("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});N.displayName="Input";var w=a(8842);let k=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(w.fC,{ref:t,className:v("relative overflow-hidden",a),...r,children:[(0,s.jsx)(w.l_,{className:"h-full w-full rounded-[inherit]",children:n}),(0,s.jsx)(z,{}),(0,s.jsx)(w.Ns,{})]})});k.displayName=w.fC.displayName;let z=n.forwardRef((e,t)=>{let{className:a,orientation:n="vertical",...r}=e;return(0,s.jsx)(w.gb,{ref:t,orientation:n,className:v("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...r,children:(0,s.jsx)(w.q4,{className:"relative flex-1 rounded-full bg-border"})})});z.displayName=w.gb.displayName;let S=0,O=new Map,T=e=>{if(O.has(e))return;let t=setTimeout(()=>{O.delete(e),D({type:"REMOVE_TOAST",toastId:e})},1e6);O.set(e,t)},E=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?T(a):e.toasts.forEach(e=>{T(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},C=[],A={toasts:[]};function D(e){A=E(A,e),C.forEach(e=>{e(A)})}function _(e){let{...t}=e,a=(S=(S+1)%Number.MAX_VALUE).toString(),s=()=>D({type:"DISMISS_TOAST",toastId:a});return D({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>D({type:"UPDATE_TOAST",toast:{...e,id:a}})}}var I=a(4930);let U=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(I.fC,{ref:t,className:v("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...n})});U.displayName=I.fC.displayName;let Z=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(I.Ee,{ref:t,className:v("aspect-square h-full w-full",a),...n})});Z.displayName=I.Ee.displayName;let M=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(I.NY,{ref:t,className:v("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n})});M.displayName=I.NY.displayName;let R="https://jsonblob.com/api/jsonBlob";async function K(e){if(!e.ok){let t=await e.text();throw Error("HTTP error! status: ".concat(e.status,", body: ").concat(t))}return e}async function H(e){try{let t=await fetch(R,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)});await K(t);let a=t.headers.get("Location"),s=null==a?void 0:a.split("/").pop();if(!s)throw Error("No blob ID returned");return s}catch(e){throw console.error("Error creating blob:",e),e}}async function L(e,t){try{let a=await fetch("".concat(R,"/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)});return await K(a),!0}catch(e){throw console.error("Error updating blob:",e),e}}async function P(e){try{let t=await fetch("".concat(R,"/").concat(e),{headers:{Accept:"application/json"}});return await K(t),t.json()}catch(e){throw console.error("Error getting blob:",e),e}}function B(e){let{initialRoomId:t}=e,[a,f]=(0,n.useState)(t||""),[x,b]=(0,n.useState)(""),[g,v]=(0,n.useState)(""),[y,w]=(0,n.useState)(null),[z,S]=(0,n.useState)(!1),[O,T]=(0,n.useState)(!1),[E,I]=(0,n.useState)(null),[R,K]=(0,n.useState)(!1),{toast:B}=function(){let[e,t]=n.useState(A);return n.useEffect(()=>(C.push(t),()=>{let e=C.indexOf(t);e>-1&&C.splice(e,1)}),[e]),{...e,toast:_,dismiss:e=>D({type:"DISMISS_TOAST",toastId:e})}}(),Y=(0,n.useRef)(null),V=async()=>{if(!x){B({title:"Hata",description:"L\xfctfen bir kullanıcı adı girin.",variant:"destructive"});return}S(!0);try{let e={messages:[],participants:[x],lastUpdated:Date.now()},t=await H(e);f(t),w({id:t,...e}),T(!0),window.history.pushState({},"","?no=".concat(t)),B({title:"Oda Oluşturuldu",description:"Oda ID: ".concat(t)})}catch(e){B({title:"Hata",description:"Oda oluşturulamadı. L\xfctfen tekrar deneyin.",variant:"destructive"})}finally{S(!1)}},q=async()=>{if(!a||!x){B({title:"Hata",description:"L\xfctfen bir kullanıcı adı ve oda ID'si girin.",variant:"destructive"});return}S(!0);try{let e=await P(a);e.participants.includes(x)||(e.participants.push(x),await L(a,e)),w({id:a,...e}),T(!0),window.history.pushState({},"","?no=".concat(a)),B({title:"Odaya Katıldınız",description:"Sohbete başlayabilirsiniz"})}catch(e){B({title:"Hata",description:"Odaya katılınamadı. Oda ID'sini kontrol edin.",variant:"destructive"}),f("")}finally{S(!1)}},J=async()=>{if(!y||!g.trim()||!x||R)return;let e={id:Math.random().toString(36).substr(2,9),sender:x,content:g.trim(),timestamp:Date.now(),replyTo:null==E?void 0:E.id,likes:0},t={...y,messages:[...y.messages,e],lastUpdated:Date.now()};try{await L(y.id,t),w(t),v(""),I(null),K(!0),setTimeout(()=>K(!1),3e3),W()}catch(e){B({title:"Hata",description:"Mesaj g\xf6nderilemedi. L\xfctfen tekrar deneyin.",variant:"destructive"})}},G=(0,n.useCallback)(async()=>{if(null==y?void 0:y.id)try{let e=await P(y.id);e.lastUpdated!==y.lastUpdated&&(w(t=>({...t,...e,messages:e.messages,lastUpdated:e.lastUpdated})),W())}catch(e){console.error("Error fetching messages:",e),B({title:"Hata",description:"Mesajlar g\xfcncellenirken bir hata oluştu.",variant:"destructive"})}},[y,B]);(0,n.useEffect)(()=>{if(O&&y){G();let e=setInterval(G,1e3);return()=>clearInterval(e)}},[O,y,G]);let W=()=>{Y.current&&(Y.current.scrollTop=Y.current.scrollHeight)};(0,n.useEffect)(()=>{W()},[null==y?void 0:y.messages]);let X=async e=>{if(!y)return;let t=y.messages.map(t=>t.id===e?{...t,likes:(t.likes||0)+1}:t),a={...y,messages:t,lastUpdated:Date.now()};try{await L(y.id,a),w(a)}catch(e){B({title:"Hata",description:"Beğeni eklenemedi. L\xfctfen tekrar deneyin.",variant:"destructive"})}},F=e=>{I(e),v("@".concat(e.sender," "))};return O?(0,s.jsxs)("div",{className:"container max-w-2xl px-4 mx-auto mt-8",children:[(0,s.jsx)("div",{className:"grid gap-4 mb-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border border-zinc-800 bg-zinc-900/50 backdrop-blur-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("span",{className:"px-2 py-1 text-xs rounded bg-zinc-800",children:["Oda: ",a]}),(0,s.jsxs)(j,{variant:"ghost",size:"sm",onClick:()=>{!function(e){navigator.clipboard.writeText(e).catch(e=>{console.error("Panoya kopyalama başarısız:",e)})}("".concat(window.location.origin,"?no=").concat(a)),B({title:"Bağlantı Kopyalandı",description:"Oda bağlantısı panoya kopyalandı."})},children:[(0,s.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"Bağlantıyı Kopyala"]}),(0,s.jsxs)("span",{className:"text-sm text-zinc-400",children:["Katılımcılar: ",null==y?void 0:y.participants.join(", ")]})]}),(0,s.jsxs)(j,{variant:"ghost",size:"sm",onClick:()=>{f(""),w(null),b(""),T(!1),I(null),window.history.pushState({},"","/")},children:[(0,s.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Odadan Ayrıl"]})]})}),(0,s.jsxs)("div",{className:"rounded-lg border border-zinc-800 bg-zinc-900/50 backdrop-blur-sm",children:[(0,s.jsx)(k,{className:"h-[600px] p-4",ref:Y,children:(0,s.jsx)("div",{className:"space-y-6",children:null==y?void 0:y.messages.map(e=>{var t;return(0,s.jsx)("div",{className:"flex ".concat(e.sender===x?"justify-end":"justify-start"),children:(0,s.jsxs)("div",{className:"flex ".concat(e.sender===x?"flex-row-reverse":"flex-row"," items-end space-x-2"),children:[(0,s.jsxs)(U,{className:"w-8 h-8",children:[(0,s.jsx)(Z,{src:"https://api.dicebear.com/6.x/initials/svg?seed=".concat(e.sender)}),(0,s.jsx)(M,{children:e.sender[0].toUpperCase()})]}),(0,s.jsxs)("div",{className:"max-w-[70%] ".concat(e.sender===x?"mr-2":"ml-2"),children:[(0,s.jsxs)("div",{className:"px-4 py-2 rounded-2xl ".concat(e.sender===x?"bg-blue-500 text-white":"bg-zinc-700 text-zinc-100"),children:[e.replyTo&&(0,s.jsxs)("div",{className:"mb-1 text-xs italic opacity-75",children:[(0,s.jsx)(d.Z,{className:"w-3 h-3 inline mr-1"}),null===(t=y.messages.find(t=>t.id===e.replyTo))||void 0===t?void 0:t.content.slice(0,30),"..."]}),(0,s.jsx)("div",{className:"break-words",children:e.content})]}),(0,s.jsxs)("div",{className:"flex items-center mt-1 space-x-2 text-xs text-zinc-400",children:[(0,s.jsx)("span",{children:e.sender}),(0,s.jsx)("span",{children:"•"}),(0,s.jsx)("span",{children:new Date(e.timestamp).toLocaleString("tr-TR",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"})}),(0,s.jsxs)(j,{variant:"ghost",size:"sm",onClick:()=>F(e),className:"p-0 h-auto text-zinc-400 hover:text-zinc-300",children:[(0,s.jsx)(u.Z,{className:"w-3 h-3 mr-1"}),"Yanıtla"]}),(0,s.jsxs)(j,{variant:"ghost",size:"sm",onClick:()=>X(e.id),className:"p-0 h-auto text-zinc-400 hover:text-zinc-300",children:[(0,s.jsx)(m.Z,{className:"w-3 h-3 mr-1"}),e.likes||0]})]})]})]})},e.id)})})}),(0,s.jsxs)("div",{className:"flex flex-col items-stretch gap-2 p-4 border-t border-zinc-800",children:[E&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 text-sm bg-zinc-800 rounded-lg",children:[(0,s.jsxs)("span",{className:"text-zinc-400",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 inline mr-2"}),"Yanıtlanan: ",E.content.slice(0,50),"..."]}),(0,s.jsx)(j,{variant:"ghost",size:"sm",onClick:()=>I(null),children:(0,s.jsx)(p.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(N,{value:g,onChange:e=>v(e.target.value),onKeyDown:e=>"Enter"===e.key&&!e.shiftKey&&J(),placeholder:"Mesajınızı yazın...",className:"bg-zinc-800 border-zinc-700",disabled:R}),(0,s.jsxs)(j,{onClick:J,disabled:!g.trim()||R,children:[(0,s.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"G\xf6nder"]})]}),R&&(0,s.jsxs)("div",{className:"text-xs text-zinc-400 text-center",children:["L\xfctfen ",3," saniye bekleyin..."]})]})]})]}):(0,s.jsx)("div",{className:"container max-w-2xl px-4 mx-auto mt-20",children:(0,s.jsxs)("div",{className:"p-6 rounded-lg border border-zinc-800 bg-zinc-900/50 backdrop-blur-sm",children:[(0,s.jsx)("h2",{className:"mb-6 text-xl font-semibold text-zinc-100",children:"Sohbet Odasına Katıl"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 text-sm text-zinc-400",children:"Kullanıcı Adınız"}),(0,s.jsx)(N,{value:x,onChange:e=>b(e.target.value),placeholder:"Kullanıcı adınızı girin",className:"bg-zinc-800 border-zinc-700"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 text-sm text-zinc-400",children:"Oda ID"}),(0,s.jsx)(N,{value:a,onChange:e=>f(e.target.value),placeholder:"Oda ID girin veya yeni oda oluşturun",className:"bg-zinc-800 border-zinc-700"})]}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsxs)(j,{onClick:q,disabled:!a||!x||z,className:"flex-1",variant:"secondary",children:[z?(0,s.jsx)(r.Z,{className:"w-4 h-4 mr-2 animate-spin"}):(0,s.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"Odaya Katıl"]}),(0,s.jsxs)(j,{onClick:V,disabled:!x||z,className:"flex-1",children:[z?(0,s.jsx)(r.Z,{className:"w-4 h-4 mr-2 animate-spin"}):(0,s.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"Yeni Oda Oluştur"]})]})]})]})})}}},function(e){e.O(0,[557,971,117,744],function(){return e(e.s=8478)}),_N_E=e.O()}]);